#:kivy 2.0.0
#:import images_path kivymd.images_path

<MainGridLayout>
    size: '1024dp','768dp'
    play:play
    slide_volume:slide_volume
    prev:prev
    next:next
    canvas:
        Rectangle:
            size:self.size
            pos:self.pos
        
    # ส่วนของโปรแกรมทั้งหมด(กล่องใหญ่สุด)
    BoxLayout:
        orientation: 'vertical'
        size: root.width,root.height

        # spacing: 20

        # ส่วนของ Playlist และ Song name
        BoxLayout:
            size: root.width,3*root.height/4
            orientation: 'horizontal'
            
            # ช่อง Playlist
            BoxLayout:
                orientation: 'vertical'
                size_hint: (None,None)
                size:self.parent.width*0.2,self.parent.height
                canvas.before:
                    Color:
                        rgba: (0,0,0,.7)
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation:'vertical'
                    size_hint:(None,None)
                    size: self.parent.width,self.parent.height*0.15
                    Label:
                        text:''
                        size_hint: 1,0.05

                    MDBoxLayout:
                        adaptive_height: True

                        MDIconButton:
                            icon: 'magnify'

                        MDTextField:
                            id: search_song
                            hint_text: 'Search Song'
                            on_text: root.Searched_Song(self.text, True)  #รับข้อมูล
                    Label:
                        text: ''
                        size_hint:(1,0.05)
                BoxLayout:
                    id:boxbox
                    orientation:'vertical'
                    size_hint:(None,None)
                    size: self.parent.width,self.parent.height*0.85
                    ScrollView:
                        do_scroll_x:False
                        do_scroll_y:True
                        bar_width:10
                        GridLayout:
                            id:playlistslide
                            cols:1
                            index:0
                            spacing:10
                            padding:10
                            size_hint:(None,None)
                            size:boxbox.width,boxbox.height
                            height:self.minimum_height
                            width:self.minimum_width
                            #  playlist  
                            

            # ช่องของ Song list
            BoxLayout:
                orientation: 'vertical'
                # ชื่อ Playlist
                BoxLayout:
                    orientation:'horizontal' 
                    size_hint: (None,None)
                    size:self.parent.width,self.parent.height*0.2
                    canvas.before:
                        Color:
                            rgba: (0,0,0,.7)
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    Label:
                        id:playlist_name
                        text:'Playlist Name'
                        color: 0 , 0 , 0 , 1
                        font_size: 42
                        font_name: 'sf'
                    BoxLayout:
                        orientation:'vertical'
                # รายละเอียดเพลงใน Playlist
                BoxLayout:
                    orientation:'horizontal'
                    padding:25,10
                    size_hint: (None,None)
                    size:self.parent.width,self.parent.height*0.1
                    canvas.before:
                        Color:
                            rgba: (0,0,0,.5)
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    Label:
                        text:'No.'
                        size_hint:(None,None)
                        size:self.parent.width*0.1,self.parent.height
                        text_size:self.width,self.height
                        halign:'left'
                        color: 0 , 0 , 0 , 1
                        font_name: 'sf'
                        font_size:16
                    Label:
                        text:'Song'
                        size_hint:(None,None)
                        size:self.parent.width*0.7,self.parent.height
                        text_size:self.width,self.height
                        halign:'left'
                        color: 0 , 0 , 0 , 1
                        font_name: 'sf'
                        font_size:16
                    Label:
                        text:'Time'
                        # size:self.parent.width*0.1,self.parent.height
                        size_hint:(None,None)
                        size:self.parent.width*0.2,self.parent.height
                        text_size:self.width,self.height
                        halign:'center'
                        color: 0 , 0 , 0 , 1
                        font_name: 'sf'
                        font_size:16
                BoxLayout:
                    orientation:'vertical'
                    size_hint: (None,None)     
                    size: self.parent.width,self.parent.height*0.7                       
                    canvas.before:
                        Color:
                            rgba: (0,0,0,.5)
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    ScrollView:
                        id: sc
                        do_scroll_x: False
                        do_scroll_y: True
                        bar_width: 15
                        SlideNorn:
                            id:sn
                            cols: 1
                            padding: 10
                            spacing: 10
                            size_hint: None, None
                            index: 0
                            width: self.minimum_width
                            height: self.minimum_height
                            size: self.parent.width,self.parent.height

        # กล่องใส่ UI เลื่อน/เล่น/หยุดเพลง และ เพิ่ม/ลดเสียง
        BoxLayout:
            size_hint: (1,0.2)
            orientation: 'horizontal'
            size: root.width,root.height/4 
            BoxLayout:
                canvas.before:
                    Color:
                        rgba: (0,0,0,.9)
                    Rectangle:
                        pos: self.pos
                        size: self.size
                # song name
                Label:
                    id:song_name
                    text:'Song name'
                    color:1,1,1,1
                    font_name: 'sf'
                    font_size:20
                # ปุ่มข้างล่าง    
            BoxLayout:
                size_hint: (1.5,1)
                orientation: 'vertical'
                canvas.before:
                    Color:
                        rgba: (0,0,0,.9)
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation:'horizontal'
                    size: self.parent.width/2,self.parent.height
                    center_x:self.parent.center_x  
                    
                    Button:
                        background_color: 0,0,0,0
                    ToggleButton:
                        id:shuffle
                        text:''
                        background_color: 0,0,0,0
                        on_state: root.shuffleState(self)
                        Image:
                            source: 'archive/icon/icon_state_1/shuffle_btn_1.png'
                            pos: self.parent.center_x - (self.parent.width/2),self.parent.center_y - (self.parent.height/2)
                            size: self.parent.width,self.parent.height
                    Button:
                        id:prev
                        text:''
                        background_color: 0,0,0,0
                        HoverImage:
                            normalImage:'archive/icon/icon_state_1/previous_btn_1.png'
                            hoverImage:'archive/icon/icon_state_2/previous_btn_2.png'
                            source: 'archive/icon/icon_state_2/previous_btn_2.png'
                            pos: self.parent.center_x - (self.parent.width/2),self.parent.center_y - (self.parent.height/2)
                            size: self.parent.width,self.parent.height
                            on_touch_down: if self.collide_point(*args[1].pos):self.otd(*args)
                            on_touch_up: if self.collide_point(*args[1].pos):self.otu(*args)
                    Button:
                        id:play
                        text: ' '
                        background_color: 0,0,0,0
                        HoverImage:
                            normalImage:'archive/icon/icon_state_1/play_btn_1.png'
                            hoverImage:'archive/icon/icon_state_2/play_btn_2.png'
                            source: 'archive/icon/icon_state_2/play_btn_2.png'
                            pos: self.parent.center_x - (self.parent.width/2),self.parent.center_y - (self.parent.height/2)
                            size: self.parent.width,self.parent.height
                            on_touch_down: if self.collide_point(*args[1].pos):self.otd(*args)
                            on_touch_up: if self.collide_point(*args[1].pos):self.otu(*args)
                    Button:
                        id:next
                        text:''
                        background_color: 0,0,0,0
                        HoverImage:
                            normalImage:'archive/icon/icon_state_1/next_btn_1.png'
                            hoverImage:'archive/icon/icon_state_2/next_btn_2.png'
                            source: 'archive/icon/icon_state_2/next_btn_2.png'
                            pos: self.parent.center_x - (self.parent.width/2),self.parent.center_y - (self.parent.height/2)
                            size: self.parent.width,self.parent.height
                            on_touch_down: if self.collide_point(*args[1].pos):self.otd(*args)
                            on_touch_up: if self.collide_point(*args[1].pos):self.otu(*args)
                    ToggleButton:
                        id:repeat
                        text:''
                        background_color: 0,0,0,0
                        on_state: root.repeatState(self)
                        Image:
                            source: 'archive/icon/icon_state_1/repeat_btn_1.png'
                            pos: self.parent.center_x - (self.parent.width/2),self.parent.center_y - (self.parent.height/2)
                            size: self.parent.width,self.parent.height

                    Label:
                        text: ''
                Slider:
                    id: playtime
                    min: 0
                    max: 10000
                    step: 1
                    value: 0
                    orientation:"horizontal"
                    on_value: root.valuechange(*args)
                    on_touch_up: root.seek(*args)
                    on_touch_down: if self.collide_point(*args[1].pos):root.notupdate(*args)
            Slider:
                id: slide_volume
                min: 0
                max: 100
                step: 1
                value: 25
                orientation:"horizontal"            
                on_value: root.slide_it(*args)
                canvas.before:
                    Color:
                        rgba: (0,0,0,.9)
                    Rectangle:
                        pos: self.pos
                        size: self.size